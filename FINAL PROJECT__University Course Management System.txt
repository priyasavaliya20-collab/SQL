==============================
     1ï¸âƒ£ Students Table
==============================

CREATE TABLE Students (
    StudentID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Email VARCHAR(100),
    BirthDate DATE,
    EnrollmentDate DATE
);

INSERT INTO Students (StudentID,FirstName,LastName,Email,BirthDate,EnrollmentDate)  VALUES 
(1,'John','Doe','john.doe@email.com','2000-01-15','2022-08-01'),
(2, 'Jane', 'Smith', 'jane.smith@email.com', '1999-05-25', '2021-08-01');

==============================
     2ï¸âƒ£ Courses Table
==============================

CREATE TABLE Courses (
    CourseID INT PRIMARY KEY,
    CourseName VARCHAR(100),
    DepartmentID INT,
    Credits INT
);

INSERT INTO Courses (CourseID,CourseName,Department,Credits) VALUES
(101, 'Introduction to SQL', 1, 3),
(102, 'Data Structures', 2, 4);

==============================
    3ï¸âƒ£ Instructors Table
==============================

CREATE TABLE Instructors (
    InstructorID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Email VARCHAR(100),
    DepartmentID INT,
    Salary DECIMAL(10,2)
);


INSERT INTO Instructors (InstructorID, FirstName,LastName,Email,DepartmentID,Salary) VALUES
(1, 'Alice', 'Johnson', 'alice.johnson@univ.com', 1, 80000),
(2, 'Bob', 'Lee', 'bob.lee@univ.com', 2, 75000);

==============================
   4ï¸âƒ£ Enrollments Table
==============================

CREATE TABLE Enrollments (
    EnrollmentID INT PRIMARY KEY,
    StudentID INT,
    CourseID INT,
    EnrollmentDate DATE
);


INSERT INTO Enrollments(EnrollmentID,StudentID,CourseID,EnrollmentDate) VALUES
(1, 1, 101, '2022-08-01'),
(2, 2, 102, '2021-08-01');

==============================
   5ï¸âƒ£ Departments Table
==============================

CREATE TABLE Departments (
    DepartmentID INT PRIMARY KEY,
    DepartmentName VARCHAR(100)
);

INSERT INTO Departments (DepartmentID,DepartmentName) VALUES
(1, 'Computer Science'),
(2, 'Mathematics');


==============================
         Queries
==============================
 
1ï¸âƒ£ Perform CRUD Operations :-

INSERT INTO Students VALUES
(3, 'Ali', 'Khan', 'ali@email.com', '2001-03-10', '2023-08-01');

SELECT * FROM Students;

UPDATE Students
SET Email = 'ali.khan@email.com'
WHERE StudentID = 3;

DELETE FROM Students
WHERE StudentID = 3;

2ï¸âƒ£ Retrieve students who enrolled after 2022 :-

SELECT *
FROM Students
WHERE EnrollmentDate > '2022-12-31';

3ï¸âƒ£ Courses offered by Mathematics department (limit 5) :-

SELECT *
FROM Courses
WHERE DepartmentID = 2
LIMIT 5;

4ï¸âƒ£ Number of students in each course (more than 5) :-

SELECT CourseID, COUNT(StudentID) AS TotalStudents
FROM Enrollments
GROUP BY CourseID
HAVING COUNT(StudentID) > 5;

5ï¸âƒ£ Students enrolled in both Introduction to SQL and Data Structures :-

SELECT s.StudentID, s.FirstName
FROM Students s
JOIN Enrollments e ON s.StudentID = e.StudentID
WHERE e.CourseID IN (101,102)
GROUP BY s.StudentID, s.FirstName
HAVING COUNT(DISTINCT e.CourseID) = 2;

6ï¸âƒ£ Students enrolled in either Introduction to SQL OR Data Structures :-

SELECT DISTINCT s.StudentID, s.FirstName
FROM Students s
JOIN Enrollments e ON s.StudentID = e.StudentID
WHERE e.CourseID IN (101,102);

7ï¸âƒ£ Average credits of all courses :-

SELECT AVG(Credits) AS AverageCredits
FROM Courses;

8ï¸âƒ£ Maximum salary of instructors in Computer Science department :-

SELECT MAX(Salary) AS MaxSalary
FROM Instructors
WHERE DepartmentID = 1;

9ï¸âƒ£ Count students enrolled in each department :-

SELECT d.DepartmentName, COUNT(e.StudentID) AS TotalStudents
FROM Departments d
JOIN Courses c ON d.DepartmentID = c.DepartmentID
JOIN Enrollments e ON c.CourseID = e.CourseID
GROUP BY d.DepartmentName;

ðŸ”Ÿ INNER JOIN â€“ Students and their courses :-

SELECT s.FirstName, c.CourseName
FROM Students s
INNER JOIN Enrollments e ON s.StudentID = e.StudentID
INNER JOIN Courses c ON e.CourseID = c.CourseID;

1ï¸âƒ£1ï¸âƒ£ LEFT JOIN â€“ All students and courses (if any) :-

SELECT s.FirstName, c.CourseName
FROM Students s
LEFT JOIN Enrollments e ON s.StudentID = e.StudentID
LEFT JOIN Courses c ON e.CourseID = c.CourseID;

1ï¸âƒ£2ï¸âƒ£ Subquery â€“ Students in courses with more than 10 students :-

SELECT *
FROM Students
WHERE StudentID IN (
    SELECT StudentID
    FROM Enrollments
    WHERE CourseID IN (
        SELECT CourseID
        FROM Enrollments
        GROUP BY CourseID
        HAVING COUNT(StudentID) > 10
    )
);

1ï¸âƒ£3ï¸âƒ£ Extract Year from EnrollmentDate :-

SELECT StudentID, YEAR(EnrollmentDate) AS EnrollmentYear
FROM Students;


1ï¸âƒ£4ï¸âƒ£ Concatenate instructor first and last name :-

SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Instructors;

1ï¸âƒ£5ï¸âƒ£ Running total of students in courses  :-

SELECT CourseID,
       COUNT(StudentID) AS TotalStudents,
       SUM(COUNT(StudentID)) OVER (ORDER BY CourseID) AS RunningTotal
FROM Enrollments
GROUP BY CourseID;


1ï¸âƒ£6ï¸âƒ£ Label students as Senior or Junior :-

SELECT StudentID,
CASE
    WHEN TIMESTAMPDIFF(YEAR, EnrollmentDate, CURDATE()) > 4 THEN 'Senior'
    ELSE 'Junior'
END AS Status
FROM Students;
